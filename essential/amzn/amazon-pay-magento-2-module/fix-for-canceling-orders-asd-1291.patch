diff --git a/Model/CheckoutSessionManagement.php b/Model/CheckoutSessionManagement.php
index d656e6c..a365901 100755
--- a/Model/CheckoutSessionManagement.php
+++ b/Model/CheckoutSessionManagement.php
@@ -793,10 +793,18 @@ class CheckoutSessionManagement implements \Amazon\Pay\Api\CheckoutSessionManage
         } catch (\Exception $e) {
             if (isset($order)) {
                 $this->closeChargePermission($amazonSessionId, $order, $e);
-                $session = $this->getAmazonSession($amazonSessionId);
-                $cancelledMessage = $this->getCanceledMessage($session);
-                $this->cancelOrder($order, $quote, $cancelledMessage);
-                $this->magentoCheckoutSession->restoreQuote();
+                // BEGIN PATCH
+                // $session = $this->getAmazonSession($amazonSessionId);
+                // $cancelledMessage = $this->getCanceledMessage($session);
+                // $this->cancelOrder($order, $quote, $cancelledMessage);
+                // $this->magentoCheckoutSession->restoreQuote();
+                if (!$this->isOrderAlreadyFinalized($order)) {
+                    $session = $this->getAmazonSession($amazonSessionId);
+                    $cancelledMessage = $this->getCanceledMessage($session);
+                    $this->cancelOrder($order, $quote, $cancelledMessage);
+                    $this->magentoCheckoutSession->restoreQuote();
+                }
+                // PATCH END
             }

             throw $e;
@@ -1175,6 +1183,40 @@ class CheckoutSessionManagement implements \Amazon\Pay\Api\CheckoutSessionManage
         return [$result];
     }

+    /**
+     * @param OrderInterface $order
+     * @return bool
+     */
+    private function isOrderAlreadyFinalized(\Magento\Sales\Api\Data\OrderInterface $order): bool
+    {
+        $payment = $order->getPayment();
+
+        if ($payment->getAdditionalInformation('charge_permission_id')) {
+            return true;
+        }
+        if ($payment->getLastTransId() && $payment->getLastTransId() !== '') {
+            return true;
+        }
+
+        $state = $order->getState();
+        if (in_array($state, [
+            \Magento\Sales\Model\Order::STATE_PROCESSING,
+            \Magento\Sales\Model\Order::STATE_COMPLETE,
+            \Magento\Sales\Model\Order::STATE_CLOSED
+        ], true)) {
+            return true;
+        }
+
+        $this->searchCriteriaBuilder->addFilter(\Magento\Sales\Api\Data\TransactionInterface::ORDER_ID, $order->getEntityId());
+        $transactions = $this->transactionRepository->getList($this->searchCriteriaBuilder->create())->getItems();
+        foreach ($transactions as $transaction) {
+            if (in_array($transaction->getTxnType(), ['authorization', 'capture'], true)) {
+                return true;
+            }
+        }
+
+        return false;
+    }
     /**
      * OrderId included in successful placement or collection
      *
@@ -1247,8 +1289,10 @@ class CheckoutSessionManagement implements \Amazon\Pay\Api\CheckoutSessionManage

         $completeCheckoutStatus = $amazonCompleteCheckoutResult['status'] ?? '404';

-        if (!preg_match('/^2\d\d$/', $completeCheckoutStatus)) {
-
+        // BEGIN PATCH
+        // if (!preg_match('/^2\d\d$/', $completeCheckoutStatus)) {
+        if (!$this->isOrderAlreadyFinalized($order) && !preg_match('/^2\d\d$/', $completeCheckoutStatus)) {
+        // END PATCH
             $session = $this->amazonAdapter->getCheckoutSession(
                 $order->getStoreId(),
                 $amazonSessionId
@@ -1257,7 +1301,12 @@ class CheckoutSessionManagement implements \Amazon\Pay\Api\CheckoutSessionManage
             $cancelledMessage = $this->getCanceledMessage($session);

             // Something went wrong, but the order has already been placed, so cancelling it
-            $this->cancelOrder($order, $quote, $cancelledMessage);
+            // BEGIN PATCH
+            // $this->cancelOrder($order, $quote, $cancelledMessage);
+            if (!$this->isOrderAlreadyFinalized($order)) {
+                $this->cancelOrder($order, $quote, $cancelledMessage);
+            }
+            // PATCH END
             $this->magentoCheckoutSession->restoreQuote();

             if (isset($session['chargePermissionId'])) {
--
2.39.5 (Apple Git-154)
